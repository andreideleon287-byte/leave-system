<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { font-family: sans-serif; background: #eee; padding: 20px; }
        .card { background: white; padding: 20px; border-radius: 12px; max-width: 600px; margin: auto; }
        input, select { width: 100%; padding: 10px; margin: 10px 0; border-radius: 5px; border: 1px solid #ddd; }
        .btn { width: 100%; padding: 12px; background: #008081; color: white; border: none; cursor: pointer; border-radius: 5px; }
        .list-item { padding: 10px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; }
    </style>
</head>
<body>
    <div class="card">
        <h2>Admin Management</h2>
        <p>Register new staff and assign departments.</p>
        <input type="text" id="newName" placeholder="Full Name (Exactly as they will type)">
        <select id="newDept">
            <option value="Wellness">Wellness</option>
            <option value="Operations">Operations</option>
            <option value="HR">HR</option>
            <option value="Warehouse">Warehouse</option>
            <option value="Admin">Admin</option>
        </select>
        <button class="btn" onclick="addStaff()">Authorize Staff</button>
        <hr>
        <div id="logs">Loading logs...</div>
    </div>

<script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbzS427LsNsLbQ1WxIpjt-ThQyPsXPVUBKhZrOhMJMoM68IW20yXEgNlZO_USIsWvWJ8xQ/exec';

    function addStaff() {
        let pin = prompt("Enter Master PIN:");
        if(pin !== "9999") return alert("Wrong PIN");
        
        let fd = new FormData();
        fd.append('action', 'addStaff');
        fd.append('staffName', document.getElementById('newName').value);
        fd.append('staffDept', document.getElementById('newDept').value);
        fd.append('pin', pin);

        fetch(scriptURL, { method: 'POST', body: fd }).then(() => {
            alert("Staff Added to Database!");
            location.reload();
        });
    }

    fetch(scriptURL + "?action=getAllData").then(r => r.json()).then(data => {
        let html = '<h3>Recent Applications</h3>';
        data.reverse().forEach(r => {
            html += `<div class="list-item"><span>${r.name}</span><strong>${r.status}</strong></div>`;
        });
        document.getElementById('logs').innerHTML = html;
    });
</script>
</body>
</html>
