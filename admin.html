<!DOCTYPE html>
<html>
<head>
    <style>
        :root { --forest: #228B22; }
        body { font-family: sans-serif; padding: 20px; background: #eee; }
        .admin-box { max-width: 800px; margin: auto; background: white; border-radius: 10px; overflow: hidden; }
        .tabs { display: flex; background: #333; color: white; }
        .tab { flex: 1; padding: 15px; text-align: center; cursor: pointer; }
        .active { background: var(--forest); }
        .content { padding: 20px; display: none; }
        .show { display: block; }
        table { width: 100%; border-collapse: collapse; }
        td, th { padding: 10px; border-bottom: 1px solid #ddd; text-align: left; }
    </style>
</head>
<body>
<div class="admin-box">
    <div class="tabs">
        <div class="tab active" onclick="tab('leaves')">All Leaves</div>
        <div class="tab" onclick="tab('staff')">Manage Staff</div>
    </div>

    <div id="leaves" class="content show">
        <h3>Master Leave List</h3>
        <div id="leaveData">Loading...</div>
    </div>

    <div id="staff" class="content">
        <h3>Staff Management</h3>
        <input type="text" id="sn" placeholder="Name">
        <input type="text" id="si" placeholder="ID">
        <button onclick="addStaff()">Add Employee</button>
        <div id="staffData"></div>
    </div>
</div>

<script>
    const url = 'https://script.google.com/macros/s/AKfycbyeSTQhQ733OekwBLvJTE0iwsFPwl4PE8_2sOmOPtdxHj4y11k4RLljfW5nW53Ol9RW7A/exec';
    function tab(id) {
        document.querySelectorAll('.content').forEach(c => c.classList.remove('show'));
        document.getElementById(id).classList.add('show');
        if(id === 'leaves') loadLeaves(); else loadStaff();
    }

    function loadLeaves() {
        fetch(url + "?action=getAllData").then(r => r.json()).then(data => {
            let h = '<table><tr><th>Staff</th><th>Status</th><th>Action</th></tr>';
            data.forEach(r => {
                h += `<tr><td>${r.name}</td><td>${r.status}</td><td><button onclick="del(${r.row})">Delete</button></td></tr>`;
            });
            document.getElementById('leaveData').innerHTML = h + '</table>';
        });
    }

    function addStaff() {
        let fd = new FormData();
        fd.append('action', 'addStaff');
        fd.append('staffName', document.getElementById('sn').value);
        fd.append('staffId', document.getElementById('si').value);
        fd.append('pin', prompt("Admin PIN"));
        fetch(url, { method: 'POST', body: fd }).then(() => loadStaff());
    }

    function loadStaff() {
        fetch(url + "?action=getStaffList").then(r => r.json()).then(data => {
            let h = '<ul>';
            data.forEach(s => h += `<li>${s.name} (${s.id})</li>`);
            document.getElementById('staffData').innerHTML = h + '</ul>';
        });
    }
    loadLeaves();
</script>
</body>
</html>